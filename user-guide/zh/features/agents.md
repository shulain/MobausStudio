# 智能体 (Agent)

智能体是 MobausStudio 的核心功能之一，让你可以创建专属的 AI 助手，配置特定的行为和能力。

## 什么是智能体？

智能体 = AI 模型 + 系统提示词 + 技能 + MCP 工具 + 权限配置

简单来说，智能体就是一个「定制化的 AI 助手」。你可以：
- 给它起一个名字和描述
- 选择使用哪个 AI 模型
- 设定它的角色和行为规则（系统提示词）
- 赋予它特定的技能
- 让它使用 MCP 工具（如读写文件、查询数据库）
- 配置权限限制，确保安全

---

## 创建智能体

### 第一步：进入智能体页面

点击侧边栏的「智能体」图标（流程图标）。

### 第二步：点击创建

点击右上角的「创建 Agent」按钮，或点击带有 + 号的虚线卡片。

### 第三步：填写基本信息

| 字段 | 说明 | 示例 |
|------|------|------|
| 名称 | 给智能体起个名字 | 代码助手、翻译专家 |
| 描述 | 简要说明用途 | 帮助审查和优化代码 |
| 模型 | 选择使用的 AI 模型 | GPT-4o、Claude 3.5 Sonnet |

### 第四步：配置系统提示词

系统提示词定义了智能体的「人设」和行为规则。例如：

```
你是一个专业的代码审查助手。
- 仔细分析用户提供的代码
- 指出潜在的 bug 和安全问题
- 提供优化建议
- 使用中文回复
```

> 💡 **提示**：好的系统提示词能让智能体更好地理解你的需求。

### 第五步：选择技能（可选）

技能是预设的提示词模板。选择技能后，其提示词会自动注入到系统提示词中。

1. 在「配置技能」区域查看可用技能
2. 勾选需要的技能
3. 可以预览技能的提示词内容

### 第六步：保存

点击「创建 Agent」按钮完成创建。

---

## 高级设置

### Temperature（温度）

控制回复的随机性：
- **0**：最确定性，适合代码、事实性问答
- **0.7**：平衡（默认）
- **1+**：更有创意，适合创作

### Max Tokens（最大令牌数）

限制回复的最大长度：
- 简短回答：500-1000
- 详细解释：2000-4000
- 长文生成：4000+

---

## MCP 工具配置

让智能体能够使用外部工具，如读写文件、执行命令等。

### 启用 MCP 工具

1. 在创建/编辑智能体时，找到「MCP 工具调用」区域
2. 打开开关启用功能
3. 选择要使用的 MCP 服务器

### 前提条件

- 需要先在 MCP 页面添加并连接 MCP 服务器
- 只有已连接的服务器才会显示在列表中

### 使用场景

| 场景 | 需要的 MCP 服务器 |
|------|------------------|
| 读写项目文件 | filesystem |
| 查询数据库 | sqlite |
| 操作 GitHub | github |

---

## 权限与安全配置

为了安全起见，你可以限制智能体的操作权限。

### 文件系统权限

| 配置项 | 说明 |
|--------|------|
| 工作目录 | 智能体的默认工作目录 |
| 允许访问的路径 | 只能访问这些目录 |
| 禁止访问的路径 | 禁止访问这些目录 |

> 💡 **提示**：桌面版可以点击文件夹图标直接选择目录。

### 工具权限规则

使用规则模式控制智能体可以执行的操作：

**允许的操作示例：**
- `Read` - 允许读取文件
- `Bash(npm run *)` - 允许执行 npm 命令
- `Bash(git *)` - 允许执行 git 命令
- `WebSearch` - 允许网页搜索

**禁止的操作示例：**
- `Bash(rm -rf *)` - 禁止删除命令
- `Bash(shutdown *)` - 禁止关机命令

### 自动批准

某些操作可以设置为自动执行，无需每次确认：

| 选项 | 说明 |
|------|------|
| 自动批准读取文件 | 读取文件时不需要确认 |
| 自动批准写入文件 | 写入文件时不需要确认 |
| 自动批准的命令模式 | 匹配的命令自动执行 |

> ⚠️ **警告**：自动批准会降低安全性，请谨慎使用。

### 执行限制

| 配置项 | 说明 | 默认值 |
|--------|------|--------|
| 最大工具调用次数 | 单次对话最多调用工具的次数 | 50 |
| 工具调用超时 | 单次工具调用的超时时间（秒） | 30 |
| 最大文件大小 | 可处理的最大文件大小（MB） | 10 |
| 沙箱模式 | 在隔离环境中执行 | 关闭 |

---

## 上下文配置

让智能体启动时自动加载特定的上下文信息。

### 自动加载的文件

指定智能体启动时自动读取的文件，例如：
- `CLAUDE.md` - 项目规范文件
- `README.md` - 项目说明

### 自动获取的 URL

指定智能体启动时自动获取的网页内容，例如：
- API 文档地址
- 参考资料链接

### 额外的系统指令

追加到系统提示词之后的额外指令。

---

## 从模板安装智能体

除了手动创建，你还可以从模板库一键安装预配置好的智能体。

### 什么是智能体模板？

智能体模板是预先配置好的智能体方案，包含：

- 完整的系统提示词
- 推荐的技能配置
- MCP 工具配置
- 权限设置

### 安装步骤

1. 在智能体页面，点击「从模板安装」按钮
2. 浏览可用的模板列表
3. 点击想要安装的模板
4. 查看模板详情，确认配置
5. 点击「安装」按钮

### 安装后

安装完成后，智能体会自动出现在你的智能体列表中。你可以：

- 直接使用
- 根据需要修改配置
- 调整权限设置

> 💡 **提示**：模板安装时会自动检查所需的技能和 MCP 服务器，如果缺少会提示你先安装。

---

## 管理智能体

### 查看智能体列表

在智能体页面可以看到所有已创建的智能体卡片，显示：

- 名称和描述
- 使用的模型及状态
- 绑定的技能数量及状态
- MCP 工具数量及连接状态
- 整体健康状态指示器

### 状态指示器说明

智能体卡片会显示各组件的运行状态，帮助你快速了解智能体是否可以正常工作：

| 组件 | 状态图标 | 说明 |
|------|----------|------|
| 模型 | 🟢 绿色 | 模型已配置且可用 |
| 模型 | 🟡 黄色 | 模型离线或不可用 |
| 模型 | 🔴 红色 | 模型未配置或已删除 |
| 技能 | 🟢 绿色 | 所有技能正常 |
| 技能 | 🟡 黄色 | 部分技能已被删除 |
| MCP | 🟢 绿色 | 所有 MCP 服务器已连接 |
| MCP | 🟡 黄色 | 部分 MCP 服务器未连接 |
| MCP | 🔴 红色 | MCP 服务器连接错误 |

> 💡 **提示**：如果看到黄色或红色状态，点击编辑智能体查看详情并修复问题。

### 搜索和筛选

- 使用搜索框按名称或描述搜索
- 使用状态筛选器查看启用/禁用的智能体

### 编辑智能体

点击智能体卡片上的「编辑」按钮，修改配置后保存。

### 删除智能体

点击智能体卡片上的「删除」按钮，确认后删除。

> ⚠️ 删除后无法恢复，请谨慎操作。

### 启用/禁用

点击智能体卡片上的开关，可以临时禁用智能体。

---

## 运行智能体

### 开始对话

点击智能体卡片上的「运行」按钮，会自动：
1. 创建一个新对话
2. 应用智能体的配置
3. 跳转到对话页面

### 在对话中使用

运行智能体后，对话会自动使用：
- 智能体配置的模型
- 智能体的系统提示词
- 智能体绑定的技能
- 智能体的 MCP 工具

---

## 使用示例

### 示例 1：代码审查助手

**配置：**
- 名称：代码审查助手
- 模型：GPT-4o
- 系统提示词：
  ```
  你是一个专业的代码审查专家。
  请仔细分析用户提供的代码，从以下方面给出建议：
  1. 代码质量和可读性
  2. 潜在的 bug 和安全问题
  3. 性能优化建议
  4. 最佳实践建议
  ```
- 技能：代码审查、代码优化

### 示例 2：项目开发助手

**配置：**
- 名称：项目开发助手
- 模型：Claude 3.5 Sonnet
- MCP 工具：filesystem（项目目录）
- 权限：
  - 工作目录：`/Users/xxx/projects/myapp`
  - 允许读取文件
  - 允许执行 `npm run *`、`git *`
- 上下文文件：`CLAUDE.md`、`README.md`

### 示例 3：翻译专家

**配置：**
- 名称：翻译专家
- 模型：GPT-4o
- 系统提示词：
  ```
  你是一个专业的翻译专家，精通中英文互译。
  翻译时请注意：
  1. 保持原文的语气和风格
  2. 专业术语使用准确
  3. 译文流畅自然
  ```
- 技能：翻译

---

## 常见问题

### 智能体和直接对话有什么区别？

直接对话使用默认设置，而智能体可以：
- 预设系统提示词，定义 AI 的角色
- 绑定技能，自动注入提示词模板
- 使用 MCP 工具，扩展 AI 能力
- 配置权限，确保安全

### 为什么 MCP 服务器列表是空的？

需要先在 MCP 页面添加并连接 MCP 服务器，只有已连接的服务器才会显示。

### 权限配置是必须的吗？

不是必须的。权限配置是可选的高级功能，用于限制智能体的操作范围，提高安全性。

---

## 下一步

- [技能系统](./skills.md) - 了解如何使用和创建技能
- [MCP 服务](./mcp.md) - 了解如何配置 MCP 工具
- [对话功能](./chat.md) - 了解对话的更多功能
